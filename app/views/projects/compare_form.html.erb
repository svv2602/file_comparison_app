<turbo-frame id="flash-messages">
  <%= turbo_stream_from 'flash-messages' %>
</turbo-frame>

<h3><%= @project.name %></h3>
<%= form_with(url: compare_project_path(@project), method: :post, local: true) do |form| %>
  <div class="row align-items-center">
    <div class="col">
      <div class="form-group">
        <%= form.label :file1_id, 'Файл, содержащий шаблонные строки ' %>
        <%= form.select :file1_id, options_from_collection_for_select(@project.uploaded_files, 'id', proc { |uf| uf.content.filename.to_s }),
                        prompt: 'Выберите файл', class: 'form-control ' %>
      </div>
    </div>
    <div class="col">
      <div class="form-group">
        <%= form.label :start_line1, 'Начальная строка для сравнения, №' %>
        <%= form.number_field :start_line1, class: 'form-control' %>
      </div>
    </div>
    <div class="col">
      <div class="form-group">
        <%= form.label :end_line1, 'Последняя строка для сравнения, №' %>
        <%= form.number_field :end_line1, class: 'form-control' %>
      </div>
    </div>
    <div class="col">
      <div class="form-group">
        <%= form.label :file2_id, 'Файл, в котором находятся строки для поиска' %>
        <%= form.select :file2_id, options_from_collection_for_select(@project.uploaded_files, 'id', proc { |uf| uf.content.filename.to_s }),
                        prompt: 'Выберите файл', class: 'form-control' %>
      </div>
    </div>
    <div class="col">
      <div class="form-group">
        <%= form.label :start_line2, 'Начальная строка для сравнения, №' %>
        <%= form.number_field :start_line2, class: 'form-control' %>
      </div>
    </div>
    <div class="col">
      <div class="form-group">
        <%= form.label :end_line2, 'Последняя строка для сравнения, №' %>
        <%= form.number_field :end_line2, class: 'form-control' %>
      </div>
    </div>
  </div>

  <div class="form-group row mt-3">
    <%= form.label :percent, 'Минимальный процент совпадений:', class: 'col-sm-3 col-form-label' %>
    <div class="col-sm-8">
      <%= form.number_field :percent, class: 'form-control', min: 0, max: 100, style: 'width: 5rem;' %>
    </div>
  </div>

  <div class="actions">
      <%= link_to "< Вернуться ", @project,  class: "btn btn-primary mt-3" %>
      <%= form.submit 'Сравнить >>', class: "btn btn-primary mt-3" %>
  </div>


<% end %>


<turbo-frame id="results">
  <% if @results.present? %>
    <%= render 'projects/compare_results', results: @results %>
  <% end %>
</turbo-frame>